{"ast":null,"code":"import _classCallCheck from\"/Users/alexandrach/Projects/tresnutye2021/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/alexandrach/Projects/tresnutye2021/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/Users/alexandrach/Projects/tresnutye2021/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/alexandrach/Projects/tresnutye2021/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React from\"react\";import{connect}from\"react-redux\";import{handleSendCode as _handleSendCode,handleCheckCode as _handleCheckCode,handleCheckToken as _handleCheckToken,GetAllChecks as _GetAllChecks}from'../../store/actions';import Countdown from'react-countdown';import InputMask from'react-input-mask';import $ from'jquery';import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var LoginForm=/*#__PURE__*/function(_React$Component){_inherits(LoginForm,_React$Component);var _super=_createSuper(LoginForm);function LoginForm(props){var _this;_classCallCheck(this,LoginForm);_this=_super.call(this,props);_this.changeNumber=function(){_this.setState({phoneNumber:false,timer:false,requestMessage:false,verifyCodeError:false});};_this.startTimer=function(e){var handleSendCode=_this.props.handleSendCode;var phoneNumber=_this.state.phoneNumber;var clearNumber=phoneNumber.replace(/\\s/g,'').replace(/[{()}]/g,'');e.preventDefault();_this.setState({timer:true,number:clearNumber.replace('+',''),code:false});handleSendCode(clearNumber.replace('+',''));$('#user_phone').val('');$('.modalBox').trigger('click');};_this.stopTimer=function(){_this.setState({timer:'ended'});var handleSendCode=_this.props.handleSendCode;handleSendCode(_this.state.number);$('.modalBox__container').trigger('click');};_this.setPhone=function(e){_this.setState({phoneNumber:e.target.value});};_this.setCode=function(e){_this.setState({code:e.target.value});};_this.submitCode=function(){var _this$props=_this.props,handleCheckCode=_this$props.handleCheckCode,user_id=_this$props.user_id;var _this$state=_this.state,code=_this$state.code,number=_this$state.number;handleCheckCode(number,code);var token=localStorage.getItem('userToken');//handleCheckToken(token)\n$('.modalBox__container').trigger('click');};_this.state={timer:false,number:false,phoneNumber:'',code:false};return _this;}_createClass(LoginForm,[{key:\"componentWillReceiveProps\",value:function componentWillReceiveProps(props,next){var requestMessage=props.requestMessage,verifyCodeError=props.verifyCodeError;var th=this;if(verifyCodeError){this.setState({verifyCodeError:verifyCodeError});}if(requestMessage){th.setState({timer:false,phoneNumber:false,requestMessage:requestMessage});$('.modalBox__container').trigger('click');}$('#user_phone').val('');$('.modalBox__container').trigger('click');}},{key:\"render\",value:function render(){var _this2=this;var _this$state2=this.state,timer=_this$state2.timer,number=_this$state2.number,requestMessage=_this$state2.requestMessage,code=_this$state2.code,phoneNumber=_this$state2.phoneNumber,verifyCodeError=_this$state2.verifyCodeError;var renderer=function renderer(_ref){var seconds=_ref.seconds,completed=_ref.completed;if(completed){return/*#__PURE__*/_jsx(Completionist,{});}else if(requestMessage){return/*#__PURE__*/_jsx(_Fragment,{});}else{return/*#__PURE__*/_jsx(\"p\",{className:\"formCodeAgain\",children:timer==='ended'?/*#__PURE__*/_jsx(_Fragment,{children:\"\\u041A\\u043E\\u0434 \\u043E\\u0442\\u043F\\u0440\\u0430\\u0432\\u043B\\u0435\\u043D \\u043F\\u043E\\u0432\\u0442\\u043E\\u0440\\u043D\\u043E\"}):/*#__PURE__*/_jsxs(_Fragment,{children:[\"\\u041F\\u043E\\u0432\\u0442\\u043E\\u0440\\u043D\\u0430\\u044F \\u043E\\u0442\\u043F\\u0440\\u0430\\u0432\\u043A\\u0430 \\u0432\\u043E\\u0437\\u043C\\u043E\\u0436\\u043D\\u0430 \\u0447\\u0435\\u0440\\u0435\\u0437\",' ',/*#__PURE__*/_jsx(\"span\",{className:\"text-violet\",children:seconds}),' ',\" \\u0441\\u0435\\u043A\"]})});}};var Completionist=function Completionist(){return/*#__PURE__*/_jsx(\"a\",{className:\"btnLink orange\",onClick:function onClick(){return _this2.stopTimer();},children:\"\\u041E\\u0442\\u043F\\u0440\\u0430\\u0432\\u0438\\u0442\\u044C \\u043F\\u043E\\u0432\\u0442\\u043E\\u0440\\u043D\\u043E\"});};return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"header\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"row justify-content-center\",children:/*#__PURE__*/_jsx(\"div\",{className:\"col-lg-auto\",children:/*#__PURE__*/_jsx(\"h2\",{className:\"text-violet text-center text-3xl mb-4\",children:\"\\u0432\\u0445\\u043E\\u0434/\\u0440\\u0435\\u0433\\u0438\\u0441\\u0442\\u0440\\u0430\\u0446\\u0438\\u044F \"})})}),/*#__PURE__*/_jsx(\"div\",{className:\"row justify-content-center\",children:/*#__PURE__*/_jsx(\"div\",{className:\"col-lg-12\",children:number&&!requestMessage?/*#__PURE__*/_jsx(\"div\",{className:\"changing-data\",children:/*#__PURE__*/_jsxs(\"p\",{children:[\"\\u041C\\u044B \\u043E\\u0442\\u043F\\u0440\\u0430\\u0432\\u0438\\u043B\\u0438 \\u043A\\u043E\\u0434 \\u043F\\u043E\\u0434\\u0442\\u0432\\u0435\\u0440\\u0436\\u0434\\u0435\\u043D\\u0438\\u044F \\u043D\\u0430 \\u043D\\u043E\\u043C\\u0435\\u0440 \",/*#__PURE__*/_jsx(\"span\",{className:\"text-violet\",children:number}),\".\",/*#__PURE__*/_jsx(\"p\",{className:\"systemMessage forPhone cursor-pointer\",onClick:function onClick(){_this2.changeNumber();},children:\"(\\u0418\\u0437\\u043C\\u0435\\u043D\\u0438\\u0442\\u044C \\u043D\\u043E\\u043C\\u0435\\u0440)\"})]})}):/*#__PURE__*/_jsx(\"p\",{children:\"\\u0412\\u0432\\u0435\\u0434\\u0438\\u0442\\u0435 \\u043D\\u043E\\u043C\\u0435\\u0440 \\u0442\\u0435\\u043B\\u0435\\u0444\\u043E\\u043D\\u0430 \\u0434\\u043B\\u044F \\u0432\\u0445\\u043E\\u0434\\u0430 \\u043D\\u0430 \\u0441\\u0430\\u0439\\u0442. \\u041C\\u044B \\u0432\\u044B\\u0448\\u043B\\u0435\\u043C \\u043A\\u043E\\u0434 \\u043F\\u043E\\u0434\\u0442\\u0432\\u0435\\u0440\\u0436\\u0434\\u0435\\u043D\\u0438\\u044F \\u0432 \\u0441\\u043C\\u0441.\"})})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"modalBox__container__content_main\",children:/*#__PURE__*/_jsxs(\"form\",{autocomplete:\"off\",onSubmit:function onSubmit(e){e.preventDefault();!timer&&_this2.startTimer(e);},children:[/*#__PURE__*/_jsx(\"input\",{type:\"hidden\",name:\"\",autoComplete:\"false\"}),verifyCodeError&&/*#__PURE__*/_jsx(\"div\",{className:\"row\",children:/*#__PURE__*/_jsx(\"div\",{className:\"col-lg-12\",children:/*#__PURE__*/_jsx(\"p\",{className:\"errorMessage\",children:verifyCodeError})})}),/*#__PURE__*/_jsx(\"div\",{className:\"row\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"col-lg-12\",children:[/*#__PURE__*/_jsx(InputMask,{className:\"w-full\",placeholder:timer?'Введите код':'Введите номер телефона'/*{...this.state}*/,mask:timer?'999999':\"+7 (999) 999 99 99\",required:true,autofill:\"false\",id:\"user_phone\",value:timer?code:phoneNumber,onChange:timer?this.setCode:this.setPhone,maskChar:\"\"}),requestMessage&&/*#__PURE__*/_jsx(\"p\",{className:\"errorMessage\",children:requestMessage})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"row justify-content-center\",children:timer?/*#__PURE__*/_jsxs(_Fragment,{children:[!requestMessage&&/*#__PURE__*/_jsx(\"div\",{className:\"col-lg-12 systemMessage mt-4\",children:/*#__PURE__*/_jsx(Countdown,{date:Date.now()+59000,intervalDelay:1000,precision:.3,renderer:renderer,children:/*#__PURE__*/_jsx(Completionist,{})})}),/*#__PURE__*/_jsx(\"div\",{className:\"col-lg-auto\",children:/*#__PURE__*/_jsx(\"button\",{className:\"btn grid mt-8 py-4 px-8\",onClick:function onClick(){return _this2.submitCode();},children:/*#__PURE__*/_jsx(\"span\",{children:\"\\u041F\\u043E\\u0434\\u0442\\u0432\\u0435\\u0440\\u0434\\u0438\\u0442\\u044C\"})})}),/*#__PURE__*/_jsx(\"p\",{className:\"systemMessage mt-4\",children:\"\\u041D\\u0430\\u0436\\u0438\\u043C\\u0430\\u044F \\u043A\\u043D\\u043E\\u043F\\u043A\\u0443 \\xAB\\u041F\\u043E\\u0434\\u0442\\u0432\\u0435\\u0440\\u0434\\u0438\\u0442\\u044C\\xBB \\u044F \\u043F\\u0440\\u0438\\u043D\\u0438\\u043C\\u0430\\u044E \\u0443\\u0441\\u043B\\u043E\\u0432\\u0438\\u044F \\u0430\\u043A\\u0446\\u0438\\u0438\"})]}):/*#__PURE__*/_jsx(\"div\",{className:\"col-lg-auto mt-8\",children:/*#__PURE__*/_jsx(\"div\",{className:\"flex justify-center handleScanContainer__inner--input pb-4\",children:/*#__PURE__*/_jsxs(\"button\",{className:\"btn grid py-4 px-8\",type:\"submit\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"bg\"}),/*#__PURE__*/_jsx(\"span\",{children:\"\\u043E\\u0442\\u043F\\u0440\\u0430\\u0432\\u0438\\u0442\\u044C \\u043A\\u043E\\u0434\"})]})})})})]})})]});}}]);return LoginForm;}(React.Component);var mapStateToProps=function mapStateToProps(state){return{codeSent:state.store.codeSent,codeVerified:state.store.codeVerified,user_id:state.store.user_id,verifyCodeError:state.store.verifyCodeError,requestMessage:state.store.requestMessage,token:state.store.token};};var mapDispatchToProps=function mapDispatchToProps(dispatch){return{// sendUserForm: (form) => dispatch(sendUserForm(form)),\nhandleSendCode:function handleSendCode(userCode){return dispatch(_handleSendCode(userCode));},handleCheckCode:function handleCheckCode(user_id,userCode){return dispatch(_handleCheckCode(user_id,userCode));},handleCheckToken:function handleCheckToken(token){return dispatch(_handleCheckToken(token));},GetAllChecks:function GetAllChecks(token){return dispatch(_GetAllChecks(token));}};};export default connect(mapStateToProps,mapDispatchToProps)(LoginForm);","map":{"version":3,"sources":["/Users/alexandrach/Projects/tresnutye2021/src/components/FormComponent/LoginForm.jsx"],"names":["React","connect","handleSendCode","handleCheckCode","handleCheckToken","GetAllChecks","Countdown","InputMask","$","LoginForm","props","changeNumber","setState","phoneNumber","timer","requestMessage","verifyCodeError","startTimer","e","state","clearNumber","replace","preventDefault","number","code","val","trigger","stopTimer","setPhone","target","value","setCode","submitCode","user_id","token","localStorage","getItem","next","th","renderer","seconds","completed","Completionist","Date","now","Component","mapStateToProps","codeSent","store","codeVerified","mapDispatchToProps","dispatch","userCode"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport { connect } from \"react-redux\";\nimport { handleSendCode, handleCheckCode, handleCheckToken, GetAllChecks } from '../../store/actions';\nimport Countdown from 'react-countdown';\nimport InputMask from 'react-input-mask';\n\nimport $ from 'jquery'\n\n\n\nclass LoginForm extends React.Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            timer: false,\n            number: false,\n            phoneNumber: '',\n            code: false\n        }\n    }\n    changeNumber = () => {\n        this.setState({\n            phoneNumber: false,\n            timer: false,\n            requestMessage: false,\n            verifyCodeError: false\n        })\n    }\n    // Повторно можно отправить код через... и отправка кода на номер\n    startTimer = (e) => {\n        const { handleSendCode } = this.props\n        const { phoneNumber } = this.state\n\n        let clearNumber = phoneNumber.replace(/\\s/g, '').replace(/[{()}]/g, '')\n        e.preventDefault()\n        this.setState({\n            timer: true,\n            number: clearNumber.replace('+', ''),\n            code: false\n        })\n        handleSendCode(clearNumber.replace('+', ''))\n        $('#user_phone').val('')\n        $('.modalBox').trigger('click')\n    }\n\n    // Код отправлен повторно\n    stopTimer = () => {\n        this.setState({\n            timer: 'ended'\n        })\n        const { handleSendCode } = this.props\n        handleSendCode(this.state.number)\n        $('.modalBox__container').trigger('click')\n    }\n\n    // Установить номер телефона\n    setPhone = e => {\n        this.setState({ phoneNumber: e.target.value })\n    }\n\n    // Ввести код\n    setCode = e => {\n        this.setState({ code: e.target.value })\n    }\n\n    // подтвердить код\n    submitCode = () => {\n        const { handleCheckCode, user_id } = this.props\n        const { code, number } = this.state\n        handleCheckCode(number, code)\n        let token = localStorage.getItem('userToken')\n        //handleCheckToken(token)\n        $('.modalBox__container').trigger('click')\n    }\n\n\n    componentWillReceiveProps(props, next) {\n        const { requestMessage, verifyCodeError } = props\n        let th = this\n        if (verifyCodeError) {\n            this.setState({ verifyCodeError: verifyCodeError })\n        }\n        if (requestMessage) {\n            th.setState({ timer: false, phoneNumber: false, requestMessage: requestMessage })\n            $('.modalBox__container').trigger('click')\n        }\n        $('#user_phone').val('')\n        $('.modalBox__container').trigger('click')\n\n    }\n    render() {\n\n        const { timer, number, requestMessage, code, phoneNumber, verifyCodeError } = this.state\n\n        const renderer = ({ seconds, completed }) => {\n            if (completed) {\n                return <Completionist />;\n            } else if (requestMessage) {\n\n                return <></>\n            } else {\n                return (\n                    <p className=\"formCodeAgain\" >\n                        {timer === 'ended' ?\n                            <>Код отправлен повторно</> :\n                            <>\n                                Повторная отправка возможна через{' '}\n                                <span className=\"text-violet\">{seconds}</span>{' '} сек\n                            </>\n                        }\n                    </p >)\n\n\n            }\n        };\n        const Completionist = () => (\n            <a className=\"btnLink orange\"\n                onClick={() => this.stopTimer()}\n            >Отправить повторно</a>\n        );\n\n        return (\n            <>\n                <header>\n                    <div className=\"row justify-content-center\">\n                        <div className=\"col-lg-auto\">\n                            <h2 className='text-violet text-center text-3xl mb-4'>\n                                вход/регистрация </h2>\n                        </div>\n                    </div>\n                    <div className=\"row justify-content-center\">\n                        <div className=\"col-lg-12\">\n                            {number && !requestMessage ?\n                                <div className=\"changing-data\">\n                                    <p>Мы отправили код подтверждения на номер <span className=\"text-violet\">{number}</span>.\n                                        <p\n                                            className=\"systemMessage forPhone cursor-pointer\"\n                                            onClick={() => {\n                                                this.changeNumber()\n                                            }}\n                                        >(Изменить номер)</p></p>\n                                </div>\n                                : <p>Введите номер телефона для входа на сайт. Мы вышлем код подтверждения в смс.</p>}\n                        </div>\n                    </div>\n                </header>\n                <div className=\"modalBox__container__content_main\">\n                    <form\n                        autocomplete=\"off\"\n                        onSubmit={(e) => {\n                            e.preventDefault()\n                            !timer && this.startTimer(e)\n                        }}\n                    >\n                        <input type=\"hidden\" name=\"\" autoComplete=\"false\" />\n                        {verifyCodeError &&\n                            <div className=\"row\">\n                                <div className=\"col-lg-12\">\n                                    <p className=\"errorMessage\">{verifyCodeError}</p>\n                                </div>\n                            </div>}\n                        <div className=\"row\">\n                            <div className=\"col-lg-12\">\n\n                                <InputMask\n                                    className='w-full'\n                                    placeholder={timer ? 'Введите код' : 'Введите номер телефона'}\n                                    /*{...this.state}*/\n                                    mask={timer ? '999999' : \"+7 (999) 999 99 99\"}\n                                    required\n                                    autofill='false'\n                                    id=\"user_phone\"\n                                    value={timer ? code : phoneNumber}\n                                    onChange={timer ? this.setCode : this.setPhone}\n                                    maskChar=\"\" />\n                                {requestMessage && <p className=\"errorMessage\">{requestMessage}</p>}\n                            </div>\n                        </div>\n                        <div className=\"row justify-content-center\">\n\n                            {timer ?\n                                <>\n                                    {!requestMessage && <div className=\"col-lg-12 systemMessage mt-4\">\n                                        <Countdown date={Date.now() + 59000} intervalDelay={1000} precision={.3} renderer={renderer}>\n                                            <Completionist />\n                                        </Countdown>\n                                    </div>}\n                                    <div className=\"col-lg-auto\">\n                                        <button className='btn grid mt-8 py-4 px-8'\n                                            onClick={() => this.submitCode()}\n                                        >\n                                            <span>Подтвердить</span>\n                                        </button>\n                                    </div>\n\n                                    <p className='systemMessage mt-4'>Нажимая кнопку «Подтвердить» я принимаю условия акции</p>\n\n                                </>\n                                :\n                                <div className=\"col-lg-auto mt-8\">\n                                    <div className=\"flex justify-center handleScanContainer__inner--input pb-4\">\n                                        <button className='btn grid py-4 px-8' type='submit'>\n                                            <div className='bg'></div>\n                                            <span>отправить код</span>\n                                        </button>\n                                    </div>\n                                </div>\n                            }\n                        </div>\n\n                    </form>\n                </div>\n            </>\n        )\n    }\n}\n\nconst mapStateToProps = (state) => {\n    return {\n        codeSent: state.store.codeSent,\n        codeVerified: state.store.codeVerified,\n        user_id: state.store.user_id,\n        verifyCodeError: state.store.verifyCodeError,\n        requestMessage: state.store.requestMessage,\n        token: state.store.token\n    };\n};\n\nconst mapDispatchToProps = (dispatch) => {\n    return {\n        // sendUserForm: (form) => dispatch(sendUserForm(form)),\n        handleSendCode: userCode => dispatch(handleSendCode(userCode)),\n        handleCheckCode: (user_id, userCode) => dispatch(handleCheckCode(user_id, userCode)),\n        handleCheckToken: (token) => dispatch(handleCheckToken(token)),\n        GetAllChecks: (token) => dispatch(GetAllChecks(token)),\n    };\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(LoginForm);\n"]},"metadata":{},"sourceType":"module"}